{"resourceType":"Library","id":"QICoreCommon","extension":[{"url":"http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-softwaresystem","valueReference":{"reference":"Device/cqf-tooling"}}],"url":"http://ecqi.healthit.gov/ecqms/Library/QICoreCommon","version":"1.2.000","name":"QICoreCommon","content":[{"contentType":"text/cql","data":"bGlicmFyeSBRSUNvcmVDb21tb24gdmVyc2lvbiAnMS4yLjAwMCcKCnVzaW5nIFFJQ29yZSB2ZXJzaW9uICc0LjEuMScKCmluY2x1ZGUgRkhJUkhlbHBlcnMgdmVyc2lvbiAnNC4xLjAwMCcKCmNvZGVzeXN0ZW0gIkxPSU5DIjogJ2h0dHA6Ly9sb2luYy5vcmcnCmNvZGVzeXN0ZW0gIlNOT01FRENUIjogJ2h0dHA6Ly9zbm9tZWQuaW5mby9zY3QnCmNvZGVzeXN0ZW0gIklDRDEwQ00iOiAnaHR0cDovL2hsNy5vcmcvZmhpci9zaWQvaWNkLTEwLWNtJwpjb2Rlc3lzdGVtICJSb2xlQ29kZSI6ICdodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL3YzLVJvbGVDb2RlJwpjb2Rlc3lzdGVtICJEaWFnbm9zaXMgUm9sZSI6ICdodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL2RpYWdub3Npcy1yb2xlJwpjb2Rlc3lzdGVtICJSZXF1ZXN0SW50ZW50IjogJ2h0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vcmVxdWVzdC1pbnRlbnQnCmNvZGVzeXN0ZW0gIk1lZGljYXRpb25SZXF1ZXN0Q2F0ZWdvcnkiOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9tZWRpY2F0aW9ucmVxdWVzdC1jYXRlZ29yeScKY29kZXN5c3RlbSAiQ29uZGl0aW9uQ2xpbmljYWxTdGF0dXNDb2RlcyI6ICdodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL2NvbmRpdGlvbi1jbGluaWNhbCcKY29kZXN5c3RlbSAiQ29uZGl0aW9uVmVyaWZpY2F0aW9uU3RhdHVzQ29kZXMiOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9jb25kaXRpb24tdmVyLXN0YXR1cycKY29kZXN5c3RlbSAiQWxsZXJneUludG9sZXJhbmNlQ2xpbmljYWxTdGF0dXNDb2RlcyI6ICdodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL2FsbGVyZ3lpbnRvbGVyYW5jZS1jbGluaWNhbCcKY29kZXN5c3RlbSAiQWxsZXJneUludG9sZXJhbmNlVmVyaWZpY2F0aW9uU3RhdHVzQ29kZXMiOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9hbGxlcmd5aW50b2xlcmFuY2UtdmVyaWZpY2F0aW9uJwpjb2Rlc3lzdGVtICJDb25kaXRpb25DYXRlZ29yeUNvZGVzIjogJ2h0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vY29uZGl0aW9uLWNhdGVnb3J5Jwpjb2Rlc3lzdGVtICJPYnNlcnZhdGlvbkNhdGVnb3J5Q29kZXMiOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9vYnNlcnZhdGlvbi1jYXRlZ29yeScKCi8vQ3VycmVudGx5IHVucmVzb2x2ZWFibGUgaW4gVlNBQwovL3ZhbHVlc2V0ICJBY3RpdmUgQ29uZGl0aW9uIjogJ2h0dHA6Ly9maGlyLm9yZy9ndWlkZXMvY3FmL2NvbW1vbi9WYWx1ZVNldC9hY3RpdmUtY29uZGl0aW9uJwovL3ZhbHVlc2V0ICJJbmFjdGl2ZSBDb25kaXRpb24iOiAnaHR0cDovL2ZoaXIub3JnL2d1aWRlcy9jcWYvY29tbW9uL1ZhbHVlU2V0L2luYWN0aXZlLWNvbmRpdGlvbicKCmNvZGUgIkJpcnRoZGF0ZSI6ICcyMTExMi04JyBmcm9tICJMT0lOQyIgZGlzcGxheSAnQmlydGggZGF0ZScKY29kZSAiRGVhZCI6ICc0MTkwOTkwMDknIGZyb20gIlNOT01FRENUIiBkaXNwbGF5ICdEZWFkJwpjb2RlICJFUiI6ICdFUicgZnJvbSAiUm9sZUNvZGUiIGRpc3BsYXkgJ0VtZXJnZW5jeSByb29tJwpjb2RlICJJQ1UiOiAnSUNVJyBmcm9tICJSb2xlQ29kZSIgZGlzcGxheSAnSW50ZW5zaXZlIGNhcmUgdW5pdCcKY29kZSAiQmlsbGluZyI6ICdiaWxsaW5nJyBmcm9tICJEaWFnbm9zaXMgUm9sZSIgZGlzcGxheSAnQmlsbGluZycKCi8vIENvbmRpdGlvbiBDbGluaWNhbCBTdGF0dXMgQ29kZXMgLSBDb25zaWRlciB2YWx1ZSBzZXRzIGZvciB0aGVzZQpjb2RlICJhY3RpdmUiOiAnYWN0aXZlJyBmcm9tICJDb25kaXRpb25DbGluaWNhbFN0YXR1c0NvZGVzIgpjb2RlICJyZWN1cnJlbmNlIjogJ3JlY3VycmVuY2UnIGZyb20gIkNvbmRpdGlvbkNsaW5pY2FsU3RhdHVzQ29kZXMiCmNvZGUgInJlbGFwc2UiOiAncmVsYXBzZScgZnJvbSAiQ29uZGl0aW9uQ2xpbmljYWxTdGF0dXNDb2RlcyIKY29kZSAiaW5hY3RpdmUiOiAnaW5hY3RpdmUnIGZyb20gIkNvbmRpdGlvbkNsaW5pY2FsU3RhdHVzQ29kZXMiCmNvZGUgInJlbWlzc2lvbiI6ICdyZW1pc3Npb24nIGZyb20gIkNvbmRpdGlvbkNsaW5pY2FsU3RhdHVzQ29kZXMiCmNvZGUgInJlc29sdmVkIjogJ3Jlc29sdmVkJyBmcm9tICJDb25kaXRpb25DbGluaWNhbFN0YXR1c0NvZGVzIgoKLy8gQ29uZGl0aW9uIFZlcmlmaWNhdGlvbiBTdGF0dXMgQ29kZXMgLSBDb25zaWRlciB2YWx1ZSBzZXRzIGZvciB0aGVzZQpjb2RlICJ1bmNvbmZpcm1lZCI6ICd1bmNvbmZpcm1lZCcgZnJvbSBDb25kaXRpb25WZXJpZmljYXRpb25TdGF0dXNDb2Rlcwpjb2RlICJwcm92aXNpb25hbCI6ICdwcm92aXNpb25hbCcgZnJvbSBDb25kaXRpb25WZXJpZmljYXRpb25TdGF0dXNDb2Rlcwpjb2RlICJkaWZmZXJlbnRpYWwiOiAnZGlmZmVyZW50aWFsJyBmcm9tIENvbmRpdGlvblZlcmlmaWNhdGlvblN0YXR1c0NvZGVzCmNvZGUgImNvbmZpcm1lZCI6ICdjb25maXJtZWQnIGZyb20gQ29uZGl0aW9uVmVyaWZpY2F0aW9uU3RhdHVzQ29kZXMKY29kZSAicmVmdXRlZCI6ICdyZWZ1dGVkJyBmcm9tIENvbmRpdGlvblZlcmlmaWNhdGlvblN0YXR1c0NvZGVzCmNvZGUgImVudGVyZWQtaW4tZXJyb3IiOiAnZW50ZXJlZC1pbi1lcnJvcicgZnJvbSBDb25kaXRpb25WZXJpZmljYXRpb25TdGF0dXNDb2RlcwoKY29kZSAiYWxsZXJneS1hY3RpdmUiOiAnYWN0aXZlJyBmcm9tICJBbGxlcmd5SW50b2xlcmFuY2VDbGluaWNhbFN0YXR1c0NvZGVzIgpjb2RlICJhbGxlcmd5LWluYWN0aXZlIjogJ2luYWN0aXZlJyBmcm9tICJBbGxlcmd5SW50b2xlcmFuY2VDbGluaWNhbFN0YXR1c0NvZGVzIgpjb2RlICJhbGxlcmd5LXJlc29sdmVkIjogJ3Jlc29sdmVkJyBmcm9tICJBbGxlcmd5SW50b2xlcmFuY2VDbGluaWNhbFN0YXR1c0NvZGVzIgoKLy8gQWxsZXJneS9JbnRvbGVyYW5jZSBWZXJpZmljYXRpb24gU3RhdHVzIENvZGVzIC0gQ29uc2lkZXIgdmFsdWUgc2V0cyBmb3IgdGhlc2UKY29kZSAiYWxsZXJneS11bmNvbmZpcm1lZCI6ICd1bmNvbmZpcm1lZCcgZnJvbSBBbGxlcmd5SW50b2xlcmFuY2VWZXJpZmljYXRpb25TdGF0dXNDb2Rlcwpjb2RlICJhbGxlcmd5LWNvbmZpcm1lZCI6ICdjb25maXJtZWQnIGZyb20gQWxsZXJneUludG9sZXJhbmNlVmVyaWZpY2F0aW9uU3RhdHVzQ29kZXMKY29kZSAiYWxsZXJneS1yZWZ1dGVkIjogJ3JlZnV0ZWQnIGZyb20gQWxsZXJneUludG9sZXJhbmNlVmVyaWZpY2F0aW9uU3RhdHVzQ29kZXMKCi8vIE1lZGljYXRpb25SZXF1ZXN0IENhdGVnb3J5IENvZGVzCmNvZGUgIkNvbW11bml0eSI6ICdjb21tdW5pdHknIGZyb20gIk1lZGljYXRpb25SZXF1ZXN0Q2F0ZWdvcnkiIGRpc3BsYXkgJ0NvbW11bml0eScKY29kZSAiRGlzY2hhcmdlIjogJ2Rpc2NoYXJnZScgZnJvbSAiTWVkaWNhdGlvblJlcXVlc3RDYXRlZ29yeSIgZGlzcGxheSAnRGlzY2hhcmdlJwoKLy8gRGlhZ25vc2lzIFJvbGUgQ29kZXMKY29kZSAiQUQiOiAnQUQnIGZyb20gIkRpYWdub3NpcyBSb2xlIiBkaXNwbGF5ICdBZG1pc3Npb24gZGlhZ25vc2lzJwpjb2RlICJERCI6ICdERCcgZnJvbSAiRGlhZ25vc2lzIFJvbGUiIGRpc3BsYXkgJ0Rpc2NoYXJnZSBkaWFnbm9zaXMnCmNvZGUgIkNDIjogJ0NDJyBmcm9tICJEaWFnbm9zaXMgUm9sZSIgZGlzcGxheSAnQ2hpZWYgY29tcGxhaW50Jwpjb2RlICJDTSI6ICdDTScgZnJvbSAiRGlhZ25vc2lzIFJvbGUiIGRpc3BsYXkgJ0NvbW9yYmlkaXR5IGRpYWdub3NpcycKY29kZSAicHJlLW9wIjogJ3ByZS1vcCcgZnJvbSAiRGlhZ25vc2lzIFJvbGUiIGRpc3BsYXkgJ3ByZS1vcCBkaWFnbm9zaXMnCmNvZGUgInBvc3Qtb3AiOiAncG9zdC1vcCcgZnJvbSAiRGlhZ25vc2lzIFJvbGUiIGRpc3BsYXkgJ3Bvc3Qtb3AgZGlhZ25vc2lzJwpjb2RlICJiaWxsaW5nIjogJ2JpbGxpbmcnIGZyb20gIkRpYWdub3NpcyBSb2xlIiBkaXNwbGF5ICdiaWxsaW5nIGRpYWdub3NpcycKCi8vIE9ic2VydmF0aW9uIENhdGVnb3J5IENvZGVzCmNvZGUgInNvY2lhbC1oaXN0b3J5IjogJ3NvY2lhbC1oaXN0b3J5JyBmcm9tICJPYnNlcnZhdGlvbkNhdGVnb3J5Q29kZXMiIGRpc3BsYXkgJ1NvY2lhbCBIaXN0b3J5Jwpjb2RlICJ2aXRhbC1zaWducyI6ICd2aXRhbC1zaWducycgZnJvbSAiT2JzZXJ2YXRpb25DYXRlZ29yeUNvZGVzIiBkaXNwbGF5ICdWaXRhbCBTaWducycKY29kZSAiaW1hZ2luZyI6ICdpbWFnaW5nJyBmcm9tICJPYnNlcnZhdGlvbkNhdGVnb3J5Q29kZXMiIGRpc3BsYXkgJ0ltYWdpbmcnCmNvZGUgImxhYm9yYXRvcnkiOiAnbGFib3JhdG9yeScgZnJvbSAiT2JzZXJ2YXRpb25DYXRlZ29yeUNvZGVzIiBkaXNwbGF5ICdMYWJvcmF0b3J5Jwpjb2RlICJwcm9jZWR1cmUiOiAncHJvY2VkdXJlJyBmcm9tICJPYnNlcnZhdGlvbkNhdGVnb3J5Q29kZXMiIGRpc3BsYXkgJ1Byb2NlZHVyZScKY29kZSAic3VydmV5IjogJ3N1cnZleScgZnJvbSAiT2JzZXJ2YXRpb25DYXRlZ29yeUNvZGVzIiBkaXNwbGF5ICdTdXJ2ZXknCmNvZGUgImV4YW0iOiAnZXhhbScgZnJvbSAiT2JzZXJ2YXRpb25DYXRlZ29yeUNvZGVzIiBkaXNwbGF5ICdFeGFtJwpjb2RlICJ0aGVyYXB5IjogJ3RoZXJhcHknIGZyb20gIk9ic2VydmF0aW9uQ2F0ZWdvcnlDb2RlcyIgZGlzcGxheSAnVGhlcmFweScKY29kZSAiYWN0aXZpdHkiOiAnYWN0aXZpdHknIGZyb20gIk9ic2VydmF0aW9uQ2F0ZWdvcnlDb2RlcyIgZGlzcGxheSAnQWN0aXZpdHknCgovLyBDb25kaXRpb24gQ2F0ZWdvcnkgQ29kZXMKY29kZSAicHJvYmxlbS1saXN0LWl0ZW0iOiAncHJvYmxlbS1saXN0LWl0ZW0nIGZyb20gIkNvbmRpdGlvbkNhdGVnb3J5Q29kZXMiIGRpc3BsYXkgJ1Byb2JsZW0gTGlzdCBJdGVtJwpjb2RlICJlbmNvdW50ZXItZGlhZ25vc2lzIjogJ2VuY291bnRlci1kaWFnbm9zaXMnIGZyb20gIkNvbmRpdGlvbkNhdGVnb3J5Q29kZXMiIGRpc3BsYXkgJ0VuY291bnRlciBEaWFnbm9zaXMnCgpjb250ZXh0IFBhdGllbnQKCi8qCkBkZXNjcmlwdGlvbjogTm9ybWFsaXplcyBhIHZhbHVlIHRoYXQgaXMgYSBjaG9pY2Ugb2YgdGltaW5nLXZhbHVlZCB0eXBlcyB0byBhbiBlcXVpdmFsZW50IGludGVydmFsCkBjb21tZW50OiBOb3JtYWxpemVzIGEgY2hvaWNlIHR5cGUgb2YgRGF0ZVRpbWUsIFF1YW5pdHR5LCBJbnRlcnZhbDxEYXRlVGltZT4sIG9yIEludGVydmFsPFF1YW50aXR5PiB0eXBlcwp0byBhbiBlcXVpdmFsZW50IGludGVydmFsLiBUaGlzIHNlbGVjdGlvbiBvZiBjaG9pY2UgdHlwZXMgaXMgYSBzdXBlcnNldCBvZiB0aGUgbWFqb3JpdHkgb2YgY2hvaWNlIHR5cGVzIHRoYXQgYXJlIHVzZWQgYXMgcG9zc2libGUKcmVwcmVzZW50YXRpb25zIGZvciB0aW1pbmctdmFsdWVkIGVsZW1lbnRzIGluIFFJQ29yZSwgYWxsb3dpbmcgdGhpcyBmdW5jdGlvbiB0byBiZSB1c2VkIGFjcm9zcyBhbnkgcmVzb3VyY2UuClRoZSBpbnB1dCBjYW4gYmUgcHJvdmlkZWQgYXMgYSBEYXRlVGltZSwgUXVhbnRpdHksIEludGVydmFsPERhdGVUaW1lPiBvciBJbnRlcnZhbDxRdWFudGl0eT4uClRoZSBpbnRlbnQgb2YgdGhpcyBmdW5jdGlvbiBpcyB0byBwcm92aWRlIGEgY2xlYXIgYW5kIGNvbmNpc2UgbWVjaGFuaXNtIHRvIHRyZWF0IHNpbmdsZQplbGVtZW50cyB0aGF0IGhhdmUgbXVsdGlwbGUgcG9zc2libGUgcmVwcmVzZW50YXRpb25zIGFzIGludGVydmFscyBzbyB0aGF0IGxvZ2ljIGRvZXNuJ3QgaGF2ZSB0byBhY2NvdW50CmZvciB0aGUgdmFyaWFiaWxpdHkuIE1vcmUgY29tcGxleCBjYWxjdWxhdGlvbnMgKHN1Y2ggYXMgbWVkaWNhdGlvbiByZXF1ZXN0IHBlcmlvZCBvciBkaXNwZW5zZSBwZXJpb2QKY2FsY3VsYXRpb24pIG5lZWQgc3BlY2lmaWMgZ3VpZGFuY2UgYW5kIGNvbnNpZGVyYXRpb24uIFRoYXQgZ3VpZGFuY2UgbWF5IG1ha2UgdXNlIG9mIHRoaXMgZnVuY3Rpb24sIGJ1dAp0aGUgZm9jdXMgb2YgdGhpcyBmdW5jdGlvbiBpcyBvbiBzaW5nbGUgZWxlbWVudCBjYWxjdWxhdGlvbnMgd2hlcmUgdGhlIHNlbWFudGljcyBhcmUgdW5hbWJpZ3VvdXMuCklmIHRoZSBpbnB1dCBpcyBhIERhdGVUaW1lLCB0aGUgcmVzdWx0IGEgRGF0ZVRpbWUgSW50ZXJ2YWwgYmVnaW5uaW5nIGFuZCBlbmRpbmcgb24gdGhhdCBEYXRlVGltZS4KSWYgdGhlIGlucHV0IGlzIGEgUXVhbnRpdHksIHRoZSBxdWFudGl0eSBpcyBleHBlY3RlZCB0byBiZSBhIGNhbGVuZGFyLWR1cmF0aW9uIGludGVycHJldGVkIGFzIGFuIEFnZSwKYW5kIHRoZSByZXN1bHQgaXMgYSBEYXRlVGltZSBJbnRlcnZhbCBiZWdpbm5pbmcgb24gdGhlIERhdGUgdGhlIHBhdGllbnQgdHVybmVkIHRoYXQgYWdlIGFuZCBlbmRpbmcgaW1tZWRpYXRlbHkgYmVmb3JlIG9uZSB5ZWFyIGxhdGVyLgpJZiB0aGUgaW5wdXQgaXMgYSBEYXRlVGltZSBJbnRlcnZhbCwgdGhlIHJlc3VsdCBpcyB0aGUgaW5wdXQuCklmIHRoZSBpbnB1dCBpcyBhIFF1YW50aXR5IEludGVydmFsLCB0aGUgcXVhbnRpdGllcyBhcmUgZXhwZWN0ZWQgdG8gYmUgY2FsZW5kYXItZHVyYXRpb25zIGludGVycHJldGVkIGFzIGFuIEFnZSwgYW5kIHRoZSByZXN1bHQKaXMgYSBEYXRlVGltZSBJbnRlcnZhbCBiZWdpbm5pbmcgb24gdGhlIGRhdGUgdGhlIHBhdGllbnQgdHVybmVkIHRoZSBhZ2UgZ2l2ZW4gYXMgdGhlIHN0YXJ0IG9mIHRoZSBxdWFudGl0eSBpbnRlcnZhbCwgYW5kIGVuZGluZwppbW1lZGlhdGVseSBiZWZvcmUgb25lIHllYXIgbGF0ZXIgdGhhbiB0aGUgZGF0ZSB0aGUgcGF0aWVudCB0dXJuZWQgdGhlIGFnZSBnaXZlbiBhcyB0aGUgZW5kIG9mIHRoZSBxdWFudGl0eSBpbnRlcnZhbC4KQW55IG90aGVyIGlucHV0IHdpbGwgcmVzbHQgaW4gYSBudWxsIERhdGVUaW1lIEludGVydmFsCiovCmRlZmluZSBmdW5jdGlvbiBUb0ludGVydmFsKGNob2ljZSBDaG9pY2U8RGF0ZVRpbWUsIFF1YW50aXR5LCBJbnRlcnZhbDxEYXRlVGltZT4sIEludGVydmFsPFF1YW50aXR5Pj4pOgogIGNhc2UKCSAgd2hlbiBjaG9pY2UgaXMgRGF0ZVRpbWUgdGhlbgogICAgCUludGVydmFsW2Nob2ljZSBhcyBEYXRlVGltZSwgY2hvaWNlIGFzIERhdGVUaW1lXQoJCXdoZW4gY2hvaWNlIGlzIEludGVydmFsPERhdGVUaW1lPiB0aGVuCiAgCQljaG9pY2UgYXMgSW50ZXJ2YWw8RGF0ZVRpbWU+CgkJd2hlbiBjaG9pY2UgaXMgUXVhbnRpdHkgdGhlbgoJCSAgSW50ZXJ2YWxbUGF0aWVudC5iaXJ0aERhdGUgKyAoY2hvaWNlIGFzIFF1YW50aXR5KSwKCQkJICBQYXRpZW50LmJpcnRoRGF0ZSArIChjaG9pY2UgYXMgUXVhbnRpdHkpICsgMSB5ZWFyKQoJCXdoZW4gY2hvaWNlIGlzIEludGVydmFsPFF1YW50aXR5PiB0aGVuCgkJICBJbnRlcnZhbFtQYXRpZW50LmJpcnRoRGF0ZSArIChjaG9pY2UubG93IGFzIFF1YW50aXR5KSwKCQkJICBQYXRpZW50LmJpcnRoRGF0ZSArIChjaG9pY2UuaGlnaCBhcyBRdWFudGl0eSkgKyAxIHllYXIpCgkJZWxzZQoJCQludWxsIGFzIEludGVydmFsPERhdGVUaW1lPgoJZW5kCgovKgpAZGVzY3JpcHRpb246IE5vcm1hbGl6ZXMgYSB2YWx1ZSB0aGF0IGlzIGEgY2hvaWNlIG9mIHRpbWluZy12YWx1ZWQgdHlwZXMgdG8gYW4gZXF1aXZhbGVudCBpbnRlcnZhbApAY29tbWVudDogTm9ybWFsaXplcyBhIGNob2ljZSB0eXBlIG9mIERhdGVUaW1lLCBRdWFuaXR0eSwgSW50ZXJ2YWw8RGF0ZVRpbWU+LCBvciBJbnRlcnZhbDxRdWFudGl0eT4gdHlwZXMKdG8gYW4gZXF1aXZhbGVudCBpbnRlcnZhbC4gVGhpcyBzZWxlY3Rpb24gb2YgY2hvaWNlIHR5cGVzIGlzIGEgc3VwZXJzZXQgb2YgdGhlIG1ham9yaXR5IG9mIGNob2ljZSB0eXBlcyB0aGF0IGFyZSB1c2VkIGFzIHBvc3NpYmxlCnJlcHJlc2VudGF0aW9ucyBmb3IgdGltaW5nLXZhbHVlZCBlbGVtZW50cyBpbiBRSUNvcmUsIGFsbG93aW5nIHRoaXMgZnVuY3Rpb24gdG8gYmUgdXNlZCBhY3Jvc3MgYW55IHJlc291cmNlLgpUaGUgaW5wdXQgY2FuIGJlIHByb3ZpZGVkIGFzIGEgRGF0ZVRpbWUsIFF1YW50aXR5LCBJbnRlcnZhbDxEYXRlVGltZT4gb3IgSW50ZXJ2YWw8UXVhbnRpdHk+LgpUaGUgaW50ZW50IG9mIHRoaXMgZnVuY3Rpb24gaXMgdG8gcHJvdmlkZSBhIGNsZWFyIGFuZCBjb25jaXNlIG1lY2hhbmlzbSB0byB0cmVhdCBzaW5nbGUKZWxlbWVudHMgdGhhdCBoYXZlIG11bHRpcGxlIHBvc3NpYmxlIHJlcHJlc2VudGF0aW9ucyBhcyBpbnRlcnZhbHMgc28gdGhhdCBsb2dpYyBkb2Vzbid0IGhhdmUgdG8gYWNjb3VudApmb3IgdGhlIHZhcmlhYmlsaXR5LiBNb3JlIGNvbXBsZXggY2FsY3VsYXRpb25zIChzdWNoIGFzIG1lZGljYXRpb24gcmVxdWVzdCBwZXJpb2Qgb3IgZGlzcGVuc2UgcGVyaW9kCmNhbGN1bGF0aW9uKSBuZWVkIHNwZWNpZmljIGd1aWRhbmNlIGFuZCBjb25zaWRlcmF0aW9uLiBUaGF0IGd1aWRhbmNlIG1heSBtYWtlIHVzZSBvZiB0aGlzIGZ1bmN0aW9uLCBidXQKdGhlIGZvY3VzIG9mIHRoaXMgZnVuY3Rpb24gaXMgb24gc2luZ2xlIGVsZW1lbnQgY2FsY3VsYXRpb25zIHdoZXJlIHRoZSBzZW1hbnRpY3MgYXJlIHVuYW1iaWd1b3VzLgpJZiB0aGUgaW5wdXQgaXMgYSBEYXRlVGltZSwgdGhlIHJlc3VsdCBhIERhdGVUaW1lIEludGVydmFsIGJlZ2lubmluZyBhbmQgZW5kaW5nIG9uIHRoYXQgRGF0ZVRpbWUuCklmIHRoZSBpbnB1dCBpcyBhIFF1YW50aXR5LCB0aGUgcXVhbnRpdHkgaXMgZXhwZWN0ZWQgdG8gYmUgYSBjYWxlbmRhci1kdXJhdGlvbiBpbnRlcnByZXRlZCBhcyBhbiBBZ2UsCmFuZCB0aGUgcmVzdWx0IGlzIGEgRGF0ZVRpbWUgSW50ZXJ2YWwgYmVnaW5uaW5nIG9uIHRoZSBEYXRlIHRoZSBwYXRpZW50IHR1cm5lZCB0aGF0IGFnZSBhbmQgZW5kaW5nIGltbWVkaWF0ZWx5IGJlZm9yZSBvbmUgeWVhciBsYXRlci4KSWYgdGhlIGlucHV0IGlzIGEgRGF0ZVRpbWUgSW50ZXJ2YWwsIHRoZSByZXN1bHQgaXMgdGhlIGlucHV0LgpJZiB0aGUgaW5wdXQgaXMgYSBRdWFudGl0eSBJbnRlcnZhbCwgdGhlIHF1YW50aXRpZXMgYXJlIGV4cGVjdGVkIHRvIGJlIGNhbGVuZGFyLWR1cmF0aW9ucyBpbnRlcnByZXRlZCBhcyBhbiBBZ2UsIGFuZCB0aGUgcmVzdWx0CmlzIGEgRGF0ZVRpbWUgSW50ZXJ2YWwgYmVnaW5uaW5nIG9uIHRoZSBkYXRlIHRoZSBwYXRpZW50IHR1cm5lZCB0aGUgYWdlIGdpdmVuIGFzIHRoZSBzdGFydCBvZiB0aGUgcXVhbnRpdHkgaW50ZXJ2YWwsIGFuZCBlbmRpbmcKaW1tZWRpYXRlbHkgYmVmb3JlIG9uZSB5ZWFyIGxhdGVyIHRoYW4gdGhlIGRhdGUgdGhlIHBhdGllbnQgdHVybmVkIHRoZSBhZ2UgZ2l2ZW4gYXMgdGhlIGVuZCBvZiB0aGUgcXVhbnRpdHkgaW50ZXJ2YWwuCkFueSBvdGhlciBpbnB1dCB3aWxsIHJlc2x0IGluIGEgbnVsbCBEYXRlVGltZSBJbnRlcnZhbAoqLwpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIHRvSW50ZXJ2YWwoY2hvaWNlIENob2ljZTxEYXRlVGltZSwgUXVhbnRpdHksIEludGVydmFsPERhdGVUaW1lPiwgSW50ZXJ2YWw8UXVhbnRpdHk+Pik6CiAgY2FzZQoJICB3aGVuIGNob2ljZSBpcyBEYXRlVGltZSB0aGVuCiAgICAJSW50ZXJ2YWxbY2hvaWNlIGFzIERhdGVUaW1lLCBjaG9pY2UgYXMgRGF0ZVRpbWVdCgkJd2hlbiBjaG9pY2UgaXMgSW50ZXJ2YWw8RGF0ZVRpbWU+IHRoZW4KICAJCWNob2ljZSBhcyBJbnRlcnZhbDxEYXRlVGltZT4KCQl3aGVuIGNob2ljZSBpcyBRdWFudGl0eSB0aGVuCgkJICBJbnRlcnZhbFtQYXRpZW50LmJpcnRoRGF0ZSArIChjaG9pY2UgYXMgUXVhbnRpdHkpLAoJCQkgIFBhdGllbnQuYmlydGhEYXRlICsgKGNob2ljZSBhcyBRdWFudGl0eSkgKyAxIHllYXIpCgkJd2hlbiBjaG9pY2UgaXMgSW50ZXJ2YWw8UXVhbnRpdHk+IHRoZW4KCQkgIEludGVydmFsW1BhdGllbnQuYmlydGhEYXRlICsgKGNob2ljZS5sb3cgYXMgUXVhbnRpdHkpLAoJCQkgIFBhdGllbnQuYmlydGhEYXRlICsgKGNob2ljZS5oaWdoIGFzIFF1YW50aXR5KSArIDEgeWVhcikKCQllbHNlCgkJCW51bGwgYXMgSW50ZXJ2YWw8RGF0ZVRpbWU+CgllbmQKCi8qCkBkZXNjcmlwdGlvbjogUmV0dXJucyBhbiBpbnRlcnZhbCByZXByZXNlbnRpbmcgdGhlIG5vcm1hbGl6ZWQgYWJhdGVtZW50IG9mIGEgZ2l2ZW4gQ29uZGl0aW9uLgpAY29tbWVudDogSWYgdGhlIGFiYXRlbWVudCBlbGVtZW50IG9mIHRoZSBDb25kaXRpb24gaXMgcmVwcmVzZW50ZWQgYXMgYSBEYXRlVGltZSwgdGhlIHJlc3VsdAppcyBhbiBpbnRlcnZhbCBiZWdpbm5pbmcgYW5kIGVuZGluZyBvbiB0aGF0IERhdGVUaW1lLgpJZiB0aGUgYWJhdGVtZW50IGlzIHJlcHJlc2VudGVkIGFzIGEgUXVhbnRpdHksIHRoZSBxdWFudGl0eSBpcyBleHBlY3RlZCB0byBiZSBhIGNhbGVuZGFyLWR1cmF0aW9uIGFuZCBpcyBpbnRlcnByZXRlZCBhcyB0aGUgYWdlIG9mIHRoZSBwYXRpZW50LiBUaGUKcmVzdWx0IGlzIGFuIGludGVydmFsIGZyb20gdGhlIGRhdGUgdGhlIHBhdGllbnQgdHVybmVkIHRoYXQgYWdlIHRvIGltbWVkaWF0ZWx5IGJlZm9yZSBvbmUgeWVhciBsYXRlci4KSWYgdGhlIGFiYXRlbWVudCBpcyByZXByZXNlbnRlZCBhcyBhIFF1YW50aXR5IEludGVydmFsLCB0aGUgcXVhbnRpdGllcyBhcmUgZXhwZWN0ZWQgdG8gYmUgY2FsZW5kYXItZHVyYXRpb25zIGFuZCBhcmUgaW50ZXJwcmV0ZWQgYXMgYW4gYWdlIHJhbmdlIGR1cmluZwp3aGljaCB0aGUgYWJhdGVtZW50IG9jY3VycmVkLiBUaGUgcmVzdWx0IGlzIGFuIGludGVydmFsIGZyb20gdGhlIGRhdGUgdGhlIHBhdGllbnQgdHVybmVkIHRoZSBzdGFydGluZyBhZ2Ugb2YgdGhlIHF1YW50aXR5IGludGVydmFsLCBhbmQgZW5kaW5nIGltbWVkaWF0ZWx5CmJlZm9yZSBvbmUgeWVhciBsYXRlciB0aGFuIHRoZSBkYXRlIHRoZSBwYXRpZW50IHR1cm5lZCB0aGUgZW5kaW5nIGFnZSBvZiB0aGUgcXVhbnRpdHkgaW50ZXJ2YWwuCiovCmRlZmluZSBmdW5jdGlvbiBUb0FiYXRlbWVudEludGVydmFsKGNvbmRpdGlvbiBDb25kaXRpb24pOgoJaWYgY29uZGl0aW9uLmFiYXRlbWVudCBpcyBEYXRlVGltZSB0aGVuCgkgIEludGVydmFsW2NvbmRpdGlvbi5hYmF0ZW1lbnQgYXMgRGF0ZVRpbWUsIGNvbmRpdGlvbi5hYmF0ZW1lbnQgYXMgRGF0ZVRpbWVdCgllbHNlIGlmIGNvbmRpdGlvbi5hYmF0ZW1lbnQgaXMgUXVhbnRpdHkgdGhlbgoJCUludGVydmFsW1BhdGllbnQuYmlydGhEYXRlICsgKGNvbmRpdGlvbi5hYmF0ZW1lbnQgYXMgUXVhbnRpdHkpLAoJCQlQYXRpZW50LmJpcnRoRGF0ZSArIChjb25kaXRpb24uYWJhdGVtZW50IGFzIFF1YW50aXR5KSArIDEgeWVhcikKCWVsc2UgaWYgY29uZGl0aW9uLmFiYXRlbWVudCBpcyBJbnRlcnZhbDxRdWFudGl0eT4gdGhlbgoJICBJbnRlcnZhbFtQYXRpZW50LmJpcnRoRGF0ZSArIChjb25kaXRpb24uYWJhdGVtZW50LmxvdyBhcyBRdWFudGl0eSksCgkJICBQYXRpZW50LmJpcnRoRGF0ZSArIChjb25kaXRpb24uYWJhdGVtZW50LmhpZ2ggYXMgUXVhbnRpdHkpICsgMSB5ZWFyKQoJZWxzZSBpZiBjb25kaXRpb24uYWJhdGVtZW50IGlzIEludGVydmFsPERhdGVUaW1lPiB0aGVuCgkgIEludGVydmFsW2NvbmRpdGlvbi5hYmF0ZW1lbnQubG93LCBjb25kaXRpb24uYWJhdGVtZW50LmhpZ2gpCgllbHNlIG51bGwgYXMgSW50ZXJ2YWw8RGF0ZVRpbWU+CgovKgpAZGVzY3JpcHRpb246IFJldHVybnMgYW4gaW50ZXJ2YWwgcmVwcmVzZW50aW5nIHRoZSBub3JtYWxpemVkIGFiYXRlbWVudCBvZiBhIGdpdmVuIENvbmRpdGlvbi4KQGNvbW1lbnQ6IElmIHRoZSBhYmF0ZW1lbnQgZWxlbWVudCBvZiB0aGUgQ29uZGl0aW9uIGlzIHJlcHJlc2VudGVkIGFzIGEgRGF0ZVRpbWUsIHRoZSByZXN1bHQKaXMgYW4gaW50ZXJ2YWwgYmVnaW5uaW5nIGFuZCBlbmRpbmcgb24gdGhhdCBEYXRlVGltZS4KSWYgdGhlIGFiYXRlbWVudCBpcyByZXByZXNlbnRlZCBhcyBhIFF1YW50aXR5LCB0aGUgcXVhbnRpdHkgaXMgZXhwZWN0ZWQgdG8gYmUgYSBjYWxlbmRhci1kdXJhdGlvbiBhbmQgaXMgaW50ZXJwcmV0ZWQgYXMgdGhlIGFnZSBvZiB0aGUgcGF0aWVudC4gVGhlCnJlc3VsdCBpcyBhbiBpbnRlcnZhbCBmcm9tIHRoZSBkYXRlIHRoZSBwYXRpZW50IHR1cm5lZCB0aGF0IGFnZSB0byBpbW1lZGlhdGVseSBiZWZvcmUgb25lIHllYXIgbGF0ZXIuCklmIHRoZSBhYmF0ZW1lbnQgaXMgcmVwcmVzZW50ZWQgYXMgYSBRdWFudGl0eSBJbnRlcnZhbCwgdGhlIHF1YW50aXRpZXMgYXJlIGV4cGVjdGVkIHRvIGJlIGNhbGVuZGFyLWR1cmF0aW9ucyBhbmQgYXJlIGludGVycHJldGVkIGFzIGFuIGFnZSByYW5nZSBkdXJpbmcKd2hpY2ggdGhlIGFiYXRlbWVudCBvY2N1cnJlZC4gVGhlIHJlc3VsdCBpcyBhbiBpbnRlcnZhbCBmcm9tIHRoZSBkYXRlIHRoZSBwYXRpZW50IHR1cm5lZCB0aGUgc3RhcnRpbmcgYWdlIG9mIHRoZSBxdWFudGl0eSBpbnRlcnZhbCwgYW5kIGVuZGluZyBpbW1lZGlhdGVseQpiZWZvcmUgb25lIHllYXIgbGF0ZXIgdGhhbiB0aGUgZGF0ZSB0aGUgcGF0aWVudCB0dXJuZWQgdGhlIGVuZGluZyBhZ2Ugb2YgdGhlIHF1YW50aXR5IGludGVydmFsLgoqLwpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIHRvQWJhdGVtZW50SW50ZXJ2YWwoY29uZGl0aW9uIENvbmRpdGlvbik6CglpZiBjb25kaXRpb24uYWJhdGVtZW50IGlzIERhdGVUaW1lIHRoZW4KCSAgSW50ZXJ2YWxbY29uZGl0aW9uLmFiYXRlbWVudCBhcyBEYXRlVGltZSwgY29uZGl0aW9uLmFiYXRlbWVudCBhcyBEYXRlVGltZV0KCWVsc2UgaWYgY29uZGl0aW9uLmFiYXRlbWVudCBpcyBRdWFudGl0eSB0aGVuCgkJSW50ZXJ2YWxbUGF0aWVudC5iaXJ0aERhdGUgKyAoY29uZGl0aW9uLmFiYXRlbWVudCBhcyBRdWFudGl0eSksCgkJCVBhdGllbnQuYmlydGhEYXRlICsgKGNvbmRpdGlvbi5hYmF0ZW1lbnQgYXMgUXVhbnRpdHkpICsgMSB5ZWFyKQoJZWxzZSBpZiBjb25kaXRpb24uYWJhdGVtZW50IGlzIEludGVydmFsPFF1YW50aXR5PiB0aGVuCgkgIEludGVydmFsW1BhdGllbnQuYmlydGhEYXRlICsgKGNvbmRpdGlvbi5hYmF0ZW1lbnQubG93IGFzIFF1YW50aXR5KSwKCQkgIFBhdGllbnQuYmlydGhEYXRlICsgKGNvbmRpdGlvbi5hYmF0ZW1lbnQuaGlnaCBhcyBRdWFudGl0eSkgKyAxIHllYXIpCgllbHNlIGlmIGNvbmRpdGlvbi5hYmF0ZW1lbnQgaXMgSW50ZXJ2YWw8RGF0ZVRpbWU+IHRoZW4KCSAgSW50ZXJ2YWxbY29uZGl0aW9uLmFiYXRlbWVudC5sb3csIGNvbmRpdGlvbi5hYmF0ZW1lbnQuaGlnaCkKCWVsc2UgbnVsbCBhcyBJbnRlcnZhbDxEYXRlVGltZT4KCi8qCkBkZXNjcmlwdGlvbjogUmV0dXJucyBhbiBpbnRlcnZhbCByZXByZXNlbnRpbmcgdGhlIG5vcm1hbGl6ZWQgcHJldmFsZW5jZSBwZXJpb2Qgb2YgYSBnaXZlbiBDb25kaXRpb24uCkBjb21tZW50OiBVc2VzIHRoZSBUb0ludGVydmFsIGFuZCBUb0FiYXRlbWVudEludGVydmFsIGZ1bmN0aW9ucyB0byBkZXRlcm1pbmUgdGhlIHdpZGVzdCBwb3RlbnRpYWwgaW50ZXJ2YWwgZnJvbQpvbnNldCB0byBhYmF0ZW1lbnQgYXMgc3BlY2lmaWVkIGluIHRoZSBnaXZlbiBDb25kaXRpb24uIElmIHRoZSBjb25kaXRpb24gaXMgYWN0aXZlLCB0aGUgcmVzdWx0aW5nIGludGVydmFsIHdpbGwgaGF2ZQphIGNsb3NlZCBlbmRpbmcgYm91bmRhcnkuIElmIHRoZSBjb25kaXRpb24gaXMgbm90IGFjdGl2ZSwgdGhlIHJlc3VsdGluZyBpbnRlcnZhbCB3aWxsIGhhdmUgYW4gb3BlbiBlbmRpbmcgYm91bmRhcnkuCiovCmRlZmluZSBmdW5jdGlvbiBUb1ByZXZhbGVuY2VJbnRlcnZhbChjb25kaXRpb24gQ29uZGl0aW9uKToKaWYgY29uZGl0aW9uLmNsaW5pY2FsU3RhdHVzIH4gImFjdGl2ZSIKICBvciBjb25kaXRpb24uY2xpbmljYWxTdGF0dXMgfiAicmVjdXJyZW5jZSIKICBvciBjb25kaXRpb24uY2xpbmljYWxTdGF0dXMgfiAicmVsYXBzZSIgdGhlbgogIEludGVydmFsW3N0YXJ0IG9mIFRvSW50ZXJ2YWwoY29uZGl0aW9uLm9uc2V0KSwgZW5kIG9mIFRvQWJhdGVtZW50SW50ZXJ2YWwoY29uZGl0aW9uKV0KZWxzZQogIEludGVydmFsW3N0YXJ0IG9mIFRvSW50ZXJ2YWwoY29uZGl0aW9uLm9uc2V0KSwgZW5kIG9mIFRvQWJhdGVtZW50SW50ZXJ2YWwoY29uZGl0aW9uKSkKCi8qCkBkZXNjcmlwdGlvbjogUmV0dXJucyBhbiBpbnRlcnZhbCByZXByZXNlbnRpbmcgdGhlIG5vcm1hbGl6ZWQgcHJldmFsZW5jZSBwZXJpb2Qgb2YgYSBnaXZlbiBDb25kaXRpb24uCkBjb21tZW50OiBVc2VzIHRoZSBUb0ludGVydmFsIGFuZCBUb0FiYXRlbWVudEludGVydmFsIGZ1bmN0aW9ucyB0byBkZXRlcm1pbmUgdGhlIHdpZGVzdCBwb3RlbnRpYWwgaW50ZXJ2YWwgZnJvbQpvbnNldCB0byBhYmF0ZW1lbnQgYXMgc3BlY2lmaWVkIGluIHRoZSBnaXZlbiBDb25kaXRpb24uIElmIHRoZSBjb25kaXRpb24gaXMgYWN0aXZlLCB0aGUgcmVzdWx0aW5nIGludGVydmFsIHdpbGwgaGF2ZQphIGNsb3NlZCBlbmRpbmcgYm91bmRhcnkuIElmIHRoZSBjb25kaXRpb24gaXMgbm90IGFjdGl2ZSwgdGhlIHJlc3VsdGluZyBpbnRlcnZhbCB3aWxsIGhhdmUgYW4gb3BlbiBlbmRpbmcgYm91bmRhcnkuCiovCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gdG9QcmV2YWxlbmNlSW50ZXJ2YWwoY29uZGl0aW9uIENvbmRpdGlvbik6CmlmIGNvbmRpdGlvbi5jbGluaWNhbFN0YXR1cyB+ICJhY3RpdmUiCiAgb3IgY29uZGl0aW9uLmNsaW5pY2FsU3RhdHVzIH4gInJlY3VycmVuY2UiCiAgb3IgY29uZGl0aW9uLmNsaW5pY2FsU3RhdHVzIH4gInJlbGFwc2UiIHRoZW4KICBJbnRlcnZhbFtzdGFydCBvZiBUb0ludGVydmFsKGNvbmRpdGlvbi5vbnNldCksIGVuZCBvZiBUb0FiYXRlbWVudEludGVydmFsKGNvbmRpdGlvbildCmVsc2UKICBJbnRlcnZhbFtzdGFydCBvZiBUb0ludGVydmFsKGNvbmRpdGlvbi5vbnNldCksIGVuZCBvZiBUb0FiYXRlbWVudEludGVydmFsKGNvbmRpdGlvbikpCgovKgpAZGVzY3JpcHRpb246IFJldHVybnMgdGhlIHRhaWwgb2YgdGhlIGdpdmVuIHVyaSAoaS5lLiBldmVyeXRoaW5nIGFmdGVyIHRoZSBsYXN0IHNsYXNoIGluIHRoZSBVUkkpLgpAY29tbWVudDogVGhpcyBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBkZXRlcm1pbmUgdGhlIGxvZ2ljYWwgaWQgb2YgYSBnaXZlbiByZXNvdXJjZS4gSXQgY2FuIGJlIHVzZWQgaW4KYSBzaW5nbGUtc2VydmVyIGVudmlyb25tZW50IHRvIHRyYWNlIHJlZmVyZW5jZXMuIEhvd2V2ZXIsIHRoaXMgZnVuY3Rpb24gZG9lcyBub3QgYXR0ZW1wdCB0byByZXNvbHZlCm9yIGRpc3Rpbmd1aXNoIHRoZSBiYXNlIG9mIHRoZSBnaXZlbiB1cmwsIGFuZCBzbyBjYW5ub3QgYmUgdXNlZCBzYWZlbHkgaW4gbXVsdGktc2VydmVyIGVudmlyb25tZW50cy4KKi8KZGVmaW5lIGZ1bmN0aW9uIEdldElkKHVyaSBTdHJpbmcgKToKICBMYXN0KFNwbGl0KHVyaSwgJy8nKSkKCi8qCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0aGUgdGFpbCBvZiB0aGUgZ2l2ZW4gdXJpIChpLmUuIGV2ZXJ5dGhpbmcgYWZ0ZXIgdGhlIGxhc3Qgc2xhc2ggaW4gdGhlIFVSSSkuCkBjb21tZW50OiBUaGlzIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGRldGVybWluZSB0aGUgbG9naWNhbCBpZCBvZiBhIGdpdmVuIHJlc291cmNlLiBJdCBjYW4gYmUgdXNlZCBpbgphIHNpbmdsZS1zZXJ2ZXIgZW52aXJvbm1lbnQgdG8gdHJhY2UgcmVmZXJlbmNlcy4gSG93ZXZlciwgdGhpcyBmdW5jdGlvbiBkb2VzIG5vdCBhdHRlbXB0IHRvIHJlc29sdmUKb3IgZGlzdGluZ3Vpc2ggdGhlIGJhc2Ugb2YgdGhlIGdpdmVuIHVybCwgYW5kIHNvIGNhbm5vdCBiZSB1c2VkIHNhZmVseSBpbiBtdWx0aS1zZXJ2ZXIgZW52aXJvbm1lbnRzLgoqLwpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIGdldElkKHVyaSBTdHJpbmcpOgogIExhc3QoU3BsaXQodXJpLCAnLycpKQoKLyoKQGRlc2NyaXB0aW9uOiBHaXZlbiBhbiBpbnRlcnZhbCwgcmV0dXJuIHRydWUgaWYgdGhlIGludGVydmFsIGhhcyBhIHN0YXJ0aW5nIGJvdW5kYXJ5IHNwZWNpZmllZAooaS5lLiB0aGUgc3RhcnQgb2YgdGhlIGludGVydmFsIGlzIG5vdCBudWxsIGFuZCBub3QgdGhlIG1pbmltdW0gRGF0ZVRpbWUgdmFsdWUpCiovCmRlZmluZSBmdW5jdGlvbiAiSGFzU3RhcnQiKHBlcmlvZCBJbnRlcnZhbDxEYXRlVGltZT4gKToKICBub3QgKCBzdGFydCBvZiBwZXJpb2QgaXMgbnVsbAogICAgICBvciBzdGFydCBvZiBwZXJpb2QgPSBtaW5pbXVtIERhdGVUaW1lCiAgKQoKLyoKQGRlc2NyaXB0aW9uOiBHaXZlbiBhbiBpbnRlcnZhbCwgcmV0dXJuIHRydWUgaWYgdGhlIGludGVydmFsIGhhcyBhIHN0YXJ0aW5nIGJvdW5kYXJ5IHNwZWNpZmllZAooaS5lLiB0aGUgc3RhcnQgb2YgdGhlIGludGVydmFsIGlzIG5vdCBudWxsIGFuZCBub3QgdGhlIG1pbmltdW0gRGF0ZVRpbWUgdmFsdWUpCiovCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gaGFzU3RhcnQocGVyaW9kIEludGVydmFsPERhdGVUaW1lPiApOgogIG5vdCAoIHN0YXJ0IG9mIHBlcmlvZCBpcyBudWxsCiAgICAgIG9yIHN0YXJ0IG9mIHBlcmlvZCA9IG1pbmltdW0gRGF0ZVRpbWUKICApCgovKgpAZGVzY3JpcHRpb246IEdpdmVuIGFuIGludGVydmFsLCByZXR1cm5zIHRydWUgaWYgdGhlIGludGVydmFsIGhhcyBhbiBlbmRpbmcgYm91bmRhcnkgc3BlY2lmaWVkCihpLmUuIHRoZSBlbmQgb2YgdGhlIGludGVydmFsIGlzIG5vdCBudWxsIGFuZCBub3QgdGhlIG1heGltdW0gRGF0ZVRpbWUgdmFsdWUpCiovCmRlZmluZSBmdW5jdGlvbiAiSGFzRW5kIihwZXJpb2QgSW50ZXJ2YWw8RGF0ZVRpbWU+ICk6CiAgbm90ICgKICAgIGVuZCBvZiBwZXJpb2QgaXMgbnVsbAogICAgICBvciBlbmQgb2YgcGVyaW9kID0gbWF4aW11bSBEYXRlVGltZQogICkKCi8qCkBkZXNjcmlwdGlvbjogR2l2ZW4gYW4gaW50ZXJ2YWwsIHJldHVybnMgdHJ1ZSBpZiB0aGUgaW50ZXJ2YWwgaGFzIGFuIGVuZGluZyBib3VuZGFyeSBzcGVjaWZpZWQKKGkuZS4gdGhlIGVuZCBvZiB0aGUgaW50ZXJ2YWwgaXMgbm90IG51bGwgYW5kIG5vdCB0aGUgbWF4aW11bSBEYXRlVGltZSB2YWx1ZSkKKi8KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBoYXNFbmQocGVyaW9kIEludGVydmFsPERhdGVUaW1lPiApOgogIG5vdCAoCiAgICBlbmQgb2YgcGVyaW9kIGlzIG51bGwKICAgICAgb3IgZW5kIG9mIHBlcmlvZCA9IG1heGltdW0gRGF0ZVRpbWUKICApCgovKgpAZGVzY3JpcHRpb246IEdpdmVuIGFuIGludGVydmFsLCByZXR1cm5zIHRoZSBlbmRpbmcgcG9pbnQgaWYgdGhlIGludGVydmFsIGhhcyBhbiBlbmRpbmcgYm91bmRhcnkgc3BlY2lmaWVkLApvdGhlcndpc2UsIHJldHVybnMgdGhlIHN0YXJ0aW5nIHBvaW50CiovCmRlZmluZSBmdW5jdGlvbiAiTGF0ZXN0IihjaG9pY2UgQ2hvaWNlPERhdGVUaW1lLCBRdWFudGl0eSwgSW50ZXJ2YWw8RGF0ZVRpbWU+LCBJbnRlcnZhbDxRdWFudGl0eT4+ICk6CiAgKGNob2ljZS50b0ludGVydmFsKCkpIHBlcmlvZAogICAgcmV0dXJuCiAgICAgIGlmIChIYXNFbmQocGVyaW9kKSkgdGhlbiBlbmQgb2YgcGVyaW9kCiAgICAgIGVsc2Ugc3RhcnQgb2YgcGVyaW9kCgovKgpAZGVzY3JpcHRpb246IEdpdmVuIGFuIGludGVydmFsLCByZXR1cm5zIHRoZSBlbmRpbmcgcG9pbnQgaWYgdGhlIGludGVydmFsIGhhcyBhbiBlbmRpbmcgYm91bmRhcnkgc3BlY2lmaWVkLApvdGhlcndpc2UsIHJldHVybnMgdGhlIHN0YXJ0aW5nIHBvaW50CiovCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gbGF0ZXN0KGNob2ljZSBDaG9pY2U8RGF0ZVRpbWUsIFF1YW50aXR5LCBJbnRlcnZhbDxEYXRlVGltZT4sIEludGVydmFsPFF1YW50aXR5Pj4gKToKICAoY2hvaWNlLnRvSW50ZXJ2YWwoKSkgcGVyaW9kCiAgICByZXR1cm4KICAgICAgaWYgKEhhc0VuZChwZXJpb2QpKSB0aGVuIGVuZCBvZiBwZXJpb2QKICAgICAgZWxzZSBzdGFydCBvZiBwZXJpb2QKCi8qCkBkZXNjcmlwdGlvbjogR2l2ZW4gYW4gaW50ZXJ2YWwsIHJldHVybiB0aGUgc3RhcnRpbmcgcG9pbnQgaWYgdGhlIGludGVydmFsIGhhcyBhIHN0YXJ0aW5nIGJvdW5kYXJ5IHNwZWNpZmllZCwKb3RoZXJ3aXNlLCByZXR1cm4gdGhlIGVuZGluZyBwb2ludAoqLwpkZWZpbmUgZnVuY3Rpb24gIkVhcmxpZXN0IihjaG9pY2UgQ2hvaWNlPERhdGVUaW1lLCBRdWFudGl0eSwgSW50ZXJ2YWw8RGF0ZVRpbWU+LCBJbnRlcnZhbDxRdWFudGl0eT4+ICk6CiAgKGNob2ljZS50b0ludGVydmFsKCkpIHBlcmlvZAogICAgcmV0dXJuCiAgICAgIGlmIChIYXNTdGFydChwZXJpb2QpKSB0aGVuIHN0YXJ0IG9mIHBlcmlvZAogICAgICBlbHNlIGVuZCBvZiBwZXJpb2QKCi8qCkBkZXNjcmlwdGlvbjogR2l2ZW4gYW4gaW50ZXJ2YWwsIHJldHVybiB0aGUgc3RhcnRpbmcgcG9pbnQgaWYgdGhlIGludGVydmFsIGhhcyBhIHN0YXJ0aW5nIGJvdW5kYXJ5IHNwZWNpZmllZCwKb3RoZXJ3aXNlLCByZXR1cm4gdGhlIGVuZGluZyBwb2ludAoqLwpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIGVhcmxpZXN0KGNob2ljZSBDaG9pY2U8RGF0ZVRpbWUsIFF1YW50aXR5LCBJbnRlcnZhbDxEYXRlVGltZT4sIEludGVydmFsPFF1YW50aXR5Pj4gKToKICAoY2hvaWNlLnRvSW50ZXJ2YWwoKSkgcGVyaW9kCiAgICByZXR1cm4KICAgICAgaWYgKEhhc1N0YXJ0KHBlcmlvZCkpIHRoZW4gc3RhcnQgb2YgcGVyaW9kCiAgICAgIGVsc2UgZW5kIG9mIHBlcmlvZAoKLyoKQGRlc2NyaXB0aW9uOiBDcmVhdGVzIGEgbGlzdCBvZiBpbnRlZ2VycyBmcm9tIDEgdG8gaG93IG1hbnkgZGF5cyBhcmUgaW4gdGhlIGludGVydmFsLiBOb3RlLCB0aGlzIHdvbnQgY3JlYXRlIGFuIGluZGV4IGZvcgp0aGUgZmluYWwgZGF5IGlmIGl0IGlzIGxlc3MgdGhhbiAyNCBob3Vycy4gVGhpcyBhbHNvIGluY2x1ZGVzIHRoZSBmaXJzdCAyNCBob3VyIHBlcmlvZC4KKi8KZGVmaW5lIGZ1bmN0aW9uICJJbnRlcnZhbCBUbyBEYXkgTnVtYmVycyIoUGVyaW9kIEludGVydmFsPERhdGVUaW1lPik6CiAgKCBleHBhbmQgeyBJbnRlcnZhbFsxLCBkdXJhdGlvbiBpbiBkYXlzIGJldHdlZW4gc3RhcnQgb2YgUGVyaW9kIGFuZCBlbmQgb2YgUGVyaW9kXX0gKSBEYXlOdW1iZXIKICAgIHJldHVybiBlbmQgb2YgRGF5TnVtYmVyCgovKgpAZGVzY3JpcHRpb246IENyZWF0ZXMgYSBsaXN0IG9mIGludGVnZXJzIGZyb20gMSB0byBob3cgbWFueSBkYXlzIGFyZSBpbiB0aGUgaW50ZXJ2YWwuIE5vdGUsIHRoaXMgd29udCBjcmVhdGUgYW4gaW5kZXggZm9yCnRoZSBmaW5hbCBkYXkgaWYgaXQgaXMgbGVzcyB0aGFuIDI0IGhvdXJzLiBUaGlzIGFsc28gaW5jbHVkZXMgdGhlIGZpcnN0IDI0IGhvdXIgcGVyaW9kLgoqLwpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIHRvRGF5TnVtYmVycyhQZXJpb2QgSW50ZXJ2YWw8RGF0ZVRpbWU+KToKICAoIGV4cGFuZCB7IEludGVydmFsWzEsIGR1cmF0aW9uIGluIGRheXMgYmV0d2VlbiBzdGFydCBvZiBQZXJpb2QgYW5kIGVuZCBvZiBQZXJpb2RdfSApIERheU51bWJlcgogICAgcmV0dXJuIGVuZCBvZiBEYXlOdW1iZXIKCi8qCkBkZXNjcmlwdGlvbjogQ3JlYXRlcyBhIGxpc3Qgb2YgMjQgaG91ciBsb25nIGludGVydmFscyBpbiBhbiBpbnRlcnZhbCBwYWlyZWQgd2l0aCB0aGUgaW5kZXggKDEgaW5kZXhlZCkgdG8gd2hpY2ggMjQgaG91ciBpbnRlcnZhbCBpdCBpcy4KTm90ZSB0aGF0IHRoZSByZXN1bHQgd2lsbCBpbmNsdWRlIGludGVydmFscyB0aGF0IGFyZSBjbG9zZWQgYXQgdGhlIGJlZ2lubmluZyBhbmQgb3BlbiBhdCB0aGUgZW5kCiovCmRlZmluZSBmdW5jdGlvbiAiRGF5cyBJbiBQZXJpb2QiKFBlcmlvZCBJbnRlcnZhbDxEYXRlVGltZT4pOgogICggIkludGVydmFsIFRvIERheSBOdW1iZXJzIihQZXJpb2QpKSBEYXlJbmRleAogICAgbGV0IHN0YXJ0UGVyaW9kOiBzdGFydCBvZiBQZXJpb2QgKyAoMjQgaG91cnMgKiAoRGF5SW5kZXggLSAxKSksCiAgICBlbmRQZXJpb2Q6IGlmIChob3VycyBiZXR3ZWVuIHN0YXJ0UGVyaW9kIGFuZCBlbmQgb2YgUGVyaW9kIDwgMjQpIHRoZW4gc3RhcnRQZXJpb2QKICAgICAgZWxzZSBzdGFydCBvZiBQZXJpb2QgKyAoMjQgaG91cnMgKiBEYXlJbmRleCkKICAgIHJldHVybiBUdXBsZSB7CiAgICAgIGRheUluZGV4OiBEYXlJbmRleCwKICAgICAgZGF5UGVyaW9kOiBJbnRlcnZhbFtzdGFydFBlcmlvZCwgZW5kUGVyaW9kKQogICAgfQoKLyoKQGRlc2NyaXB0aW9uOiBDcmVhdGVzIGEgbGlzdCBvZiAyNCBob3VyIGxvbmcgaW50ZXJ2YWxzIGluIGFuIGludGVydmFsIHBhaXJlZCB3aXRoIHRoZSBpbmRleCAoMSBpbmRleGVkKSB0byB3aGljaCAyNCBob3VyIGludGVydmFsIGl0IGlzLgpOb3RlIHRoYXQgdGhlIHJlc3VsdCB3aWxsIGluY2x1ZGUgaW50ZXJ2YWxzIHRoYXQgYXJlIGNsb3NlZCBhdCB0aGUgYmVnaW5uaW5nIGFuZCBvcGVuIGF0IHRoZSBlbmQKKi8KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBkYXlzSW5QZXJpb2QoUGVyaW9kIEludGVydmFsPERhdGVUaW1lPik6CiAgKCAiSW50ZXJ2YWwgVG8gRGF5IE51bWJlcnMiKFBlcmlvZCkpIERheUluZGV4CiAgICBsZXQgc3RhcnRQZXJpb2Q6IHN0YXJ0IG9mIFBlcmlvZCArICgyNCBob3VycyAqIChEYXlJbmRleCAtIDEpKSwKICAgIGVuZFBlcmlvZDogaWYgKGhvdXJzIGJldHdlZW4gc3RhcnRQZXJpb2QgYW5kIGVuZCBvZiBQZXJpb2QgPCAyNCkgdGhlbiBzdGFydFBlcmlvZAogICAgICBlbHNlIHN0YXJ0IG9mIFBlcmlvZCArICgyNCBob3VycyAqIERheUluZGV4KQogICAgcmV0dXJuIFR1cGxlIHsKICAgICAgZGF5SW5kZXg6IERheUluZGV4LAogICAgICBkYXlQZXJpb2Q6IEludGVydmFsW3N0YXJ0UGVyaW9kLCBlbmRQZXJpb2QpCiAgICB9Cg=="}]}